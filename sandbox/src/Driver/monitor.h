#pragma once

#include <ntddk.h>

/////////////////////////////////////////////////////////////////////////////
// DEFINES
/////////////////////////////////////////////////////////////////////////////

#define MONIT_POOL_TAG 'monP'


/////////////////////////////////////////////////////////////////////////////
// STRUCTS
/////////////////////////////////////////////////////////////////////////////

typedef struct _MONITORED_PROCESS_ENTRY
{
    SINGLE_LIST_ENTRY SingleListEntry;
    ULONG ProcessId;
} MONITORED_PROCESS_ENTRY, *PMONITORED_PROCESS_ENTRY;



/////////////////////////////////////////////////////////////////////////////
// GLOBALS
/////////////////////////////////////////////////////////////////////////////

//
// Monitored processes list
//

PMONITORED_PROCESS_ENTRY gMonitoredProcessList;


/////////////////////////////////////////////////////////////////////////////
// PROTOTYPES
/////////////////////////////////////////////////////////////////////////////

BOOLEAN
MonIsProcessMonitored(ULONG Pid);
NTSTATUS
MonAddProcessToMonitoredList(ULONG TargetPid);